
import sqlite3

conn = sqlite3.connect(r"D:\Projekt_FakeNews_Detection\dataverse_files\nelagt2022.db")
cursor = conn.cursor()
sql_query = """SELECT name FROM sqlite_master
    WHERE type='table';"""
cursor.execute(sql_query)
print(cursor.fetchall())



import pandas as pd
import sqlalchemy as sql

engine = sql.create_engine("sqlite:///D:\\Projekt_FakeNews_Detection\\dataverse_files\\nelagt2022.db")
df = pd.read_sql_table("newsdata", engine)

#word count
df["word_count"] = df["content"].apply(lambda x:len(x.split(" ")))

#
df_all = df.merge(right=labels, on="source" ,how="left")
target = df_all["label"]
